<%- layout("layouts/main") %>
    <link rel="stylesheet" href="/assets/css/home.css">
    <link rel="stylesheet" href="/assets/css/form_section.css">
    <link rel="stylesheet" href="/assets/css/product_template.css">

    <!-- Sección de datos del usuario -->
    <div class="user-data-section">
        <h3>¡Hola <%= user %>!</h3>
        <p>Sesión iniciada: <strong>
                <%= new Date().toLocaleString() %>
            </strong></p>
    </div>

    <!-- Resto del contenido de la página -->
    <div class="main-content">
        <h1>Sistema de facturación Bill.io</h1>
        <section class="buttons-sections">
            <button class="add-product" id="add-product">cargar producto</button>
            <button class="add-client" id="add-client">cargar cliente</button>

        </section>

        <!-- aqui se clonan los templates -->
        <div id="templates-content">
            Selecciona una acción
        </div>

        <%- include('./partials/modal_client') %>
    </div>

    <!-- templates -->

    <template id="add-client-temp">
        <section class="search-client">
            <input type="text" placeholder="buscar cliente" id="search-client">
        </section>
        <form id="client-form">

            <section class="row-group">

                <div class="group-form-client">
                    <label for="name">nombre y apellido</label>
                    <input type="text" id="name" name="name" autofocus>
                </div>

                <div class="group-form-client">
                    <label for="cuit">C.U.I.T</label>
                    <input type="text" id="cuit" name="cuit">
                </div>

            </section>
            <section class="row-group">

                <div class="group-form-client">
                    <label for="address">dirección</label>
                    <input type="text" id="address" name="address">
                </div>

                <div class="group-form-client">
                    <label for="phone">teléfono</label>
                    <input type="phone" id="phone" name="phone">
                </div>

            </section>

            <section class="row-group">
                <div class="group-form-client">
                    <label for="email">email</label>
                    <input type="email" id="email" name="email">
                </div>

            </section>

            <section class="buttons-form">
                <button type="submit" class="btn-submit-primary">grabar y continuar</button>
                <button type="button" class="btn-reset-warning">resetear</button>
            </section>
        </form>
    </template>

    <template id="add-product-temp">
        <div class="product-template-container">
            <section class="search-product">
                <input type="text" id="search-product-input" placeholder="buscar producto por ID, nombre, o precio">
                <div class="result-list"></div>
            </section>

            <section class="table-result">
                <table>
                    <thead>
                        <tr>
                            <th>código</th>
                            <th>nombre</th>
                            <th>precio</th>
                            <th>cantidad</th>
                            <th>subtotal</th>
                            <th>accion</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Los productos se insertan dinámicamente aquí -->
                    </tbody>
                    <tfoot style="display: none;">
                        <!-- El total se inserta dinámicamente aquí -->
                    </tfoot>
                </table>
            </section>

            <div class="invoice-actions">
                <button id="btn-facturar">continuar</button>
                <button id="btn-limpiar">limpiar</button>
            </div>
        </div>
    </template>

    <script>
        // Se declara una variable global (o de ámbito de módulo) para almacenar los datos.
        // Usamos JSON.parse() del lado del cliente para asegurarnos de que el tipo sea correcto.
        window.ALL_CLIENTS = JSON.parse('<%- clients %>');
        window.ALL_PRODUCTS = JSON.parse('<%- products %>');
    </script>

    
    <!-- Archivo principal (depende de todos los módulos) -->
    <script type="module" src="/assets/js/home.js"></script>
